dist: bionic
sudo: required
services:
  - docker

env:
  # Global environment variables
  global:
    # Commit SHA for tracking needs
    - COMMIT_SHA=${TRAVIS_COMMIT::8}

stages:
  - name: "Prepare"
    if: |
      branch =~ /^release\/(.*)/ OR \
      branch = tuple1

  - name: "Deploy"
    if: type = pull_request

jobs:
  include:
    - stage: Prepare
      script:
        - set -Eeo pipefail
        - chmod 755 ./scripts/envinfo.sh
        - bash ./scripts/envinfo.sh > envinfo.txt
        - cat envinfo.txt

        - echo "~~ Build Success ~~"
    - stage: Deploy
      script:
        - set -Eeo pipefail
        - chmod 755 ./scripts/envinfo.sh
        - bash ./scripts/envinfo.sh > envinfo.txt
        - cat envinfo.txt

        - echo "~~ Deploy Success ~~"

notifications:
  email:
    #recipients:
    #  - ${AUTH_EMAIL}
    on_success: never
    on_failure: never
    on_cancel: never
